(()=>{var Me=Object.create;var F=Object.defineProperty,ve=Object.defineProperties,Qe=Object.getOwnPropertyDescriptor,Ee=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,he=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var W=(t,r,e)=>r in t?F(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,d=(t,r)=>{for(var e in r||(r={}))_.call(r,e)&&W(t,e,r[e]);if(S)for(var e of S(r))$.call(r,e)&&W(t,e,r[e]);return t},x=(t,r)=>ve(t,Ee(r));var T=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(r,e)=>(typeof require!="undefined"?require:r)[e]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var J=(t,r)=>{var e={};for(var n in t)_.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&S)for(var n of S(t))r.indexOf(n)<0&&$.call(t,n)&&(e[n]=t[n]);return e};var Ue=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of ge(r))!_.call(t,i)&&i!==e&&F(t,i,{get:()=>r[i],enumerable:!(n=Qe(r,i))||n.enumerable});return t};var h=(t,r,e)=>(e=t!=null?Me(he(t)):{},Ue(r||!t||!t.__esModule?F(e,"default",{value:t,enumerable:!0}):e,t));var A=h(T("react")),B=T("react-query"),j=T("react-query/devtools");var I=h(T("react")),X=T("react-query"),b={login:()=>Promise.resolve(),logout:()=>Promise.resolve(),checkAuth:()=>Promise.resolve(),checkError:()=>Promise.resolve(),getPermissions:()=>Promise.resolve(),getUserIdentity:()=>Promise.resolve()},E=I.default.createContext(b),Y=({login:t=b.login,logout:r=b.logout,checkAuth:e=b.checkAuth,checkError:n=b.checkError,getPermissions:i=b.getPermissions,getUserIdentity:y=b.getUserIdentity,isProvided:s,children:u})=>{let[l,o]=(0,I.useState)(!1),a=(0,X.useQueryClient)();(0,I.useEffect)(()=>{a.invalidateQueries(["useAuthenticated"])},[l]);let p=async c=>{try{let m=await t(c);return o(!0),Promise.resolve(m)}catch(m){throw o(!1),m}},D=async c=>{try{let m=await r(c);return o(!1),Promise.resolve(m)}catch(m){throw o(!0),m}},f=async c=>{try{await e(c),o(!0)}catch(m){throw m!=null&&m.redirectPath&&console.log(m.redirectPath),o(!1),m}};return I.default.createElement(E.Provider,{value:{login:p,logout:D,checkAuth:f,checkError:n,getPermissions:i,getUserIdentity:y,isAuthenticated:l,isProvided:s}},u)};var z=h(T("react")),be=()=>({default:{create:()=>Promise.resolve({data:{id:1}}),createMany:()=>Promise.resolve({data:[]}),deleteOne:()=>Promise.resolve({data:{id:1}}),deleteMany:()=>Promise.resolve({data:[]}),getList:()=>Promise.resolve({data:[],total:0}),getMany:()=>Promise.resolve({data:[]}),getOne:()=>Promise.resolve({data:{id:1}}),update:()=>Promise.resolve({data:{id:1}}),updateMany:()=>Promise.resolve({data:[]}),custom:()=>Promise.resolve({data:{}}),getApiUrl:()=>""}}),N=z.default.createContext(be()),Z=e=>{var n=e,{children:t}=n,r=J(n,["children"]);let i;return!r.hasOwnProperty("updateMany")||!r.hasOwnProperty("createMany")?i=r:i={default:r},z.default.createElement(N.Provider,{value:i},t)};var rt=({authProvider:t,children:r,reactQueryClientConfig:e,dataProvider:n})=>{var y;let i=new B.QueryClient(x(d({},e),{defaultOptions:x(d({},e==null?void 0:e.defaultOptions),{queries:d({refetchOnWindowFocus:!1,keepPreviousData:!0},(y=e==null?void 0:e.defaultOptions)==null?void 0:y.queries)})}));return A.default.createElement(B.QueryClientProvider,{client:i},A.default.createElement(Y,x(d({},t),{isProvided:!!t}),A.default.createElement(Z,d({},n),A.default.createElement(A.default.Fragment,null,r))),A.default.createElement(j.ReactQueryDevtools,d({initialIsOpen:!1,position:"bottom-right"},e)))};var O=T("react-query");var M=(t,r,e)=>{let n=r||"default",i={all:[n],resourceAll:[n,t],list:y=>[...i.resourceAll,"list",d(d({},y),e)],many:y=>[...i.resourceAll,"getMany",y&&y.map(String),d({},e)].filter(s=>s!==void 0),detail:y=>[...i.resourceAll,"detail",y==null?void 0:y.toString(),d({},e)]};return i};var Ie=({resource:t,config:r,queryOptions:e,metaData:n,dataProviderName:i})=>{let y=R(),s=M(t,i,n),{getList:u}=y(i);return(0,O.useQuery)(s.list(r),()=>u(x(d({resource:t},r),{metaData:n})),x(d({},e),{onSuccess:o=>{var a;(a=e==null?void 0:e.onSuccess)==null||a.call(e,o)},onError:o=>{var a;(a=e==null?void 0:e.onError)==null||a.call(e,o)}}))};var q=T("react-query");var Ae=({resource:t,id:r,queryOptions:e,metaData:n,dataProviderName:i})=>{let y=R(),s=M(t,i,n),{getOne:u}=y(i);return(0,q.useQuery)(s.detail(r),()=>u({resource:t,id:r,metaData:n}),x(d({},e),{onSuccess:o=>{var a;(a=e==null?void 0:e.onSuccess)==null||a.call(e,o)},onError:o=>{var a;(a=e==null?void 0:e.onError)==null||a.call(e,o)}}))};var ee=T("react-query");var Se=({resource:t,ids:r,queryOptions:e,metaData:n,dataProviderName:i})=>{let y=R(),s=M(t,i,n),{getMany:u}=y(i),l=(e==null?void 0:e.enabled)===void 0||(e==null?void 0:e.enabled)===!0;return(0,ee.useQuery)(s.many(r),()=>u({resource:t,ids:r,metaData:n}),x(d({},e),{onSuccess:a=>{var p;(p=e==null?void 0:e.onSuccess)==null||p.call(e,a)},onError:a=>{var p;(p=e==null?void 0:e.onError)==null||p.call(e,a)}}))};var K=T("react-query");var Be=()=>{let t=(0,K.useQueryClient)(),r=R(),{mutationMode:e,undoableTimeout:n}=U(),i=g();return(0,K.useMutation)(({id:s,values:u,resource:l,mutationMode:o,undoableTimeout:a,onCancel:p,metaData:D,dataProviderName:f})=>{let c=o!=null?o:e,m=a!=null?a:n;return c!=="undoable"?r(f).update({resource:l,id:s,variables:u,metaData:D}):new Promise((C,v)=>{let H=()=>{r(f).update({resource:l,id:s,variables:u,metaData:D}).then(Q=>C(Q)).catch(Q=>v(Q))};p&&p(()=>{v({message:"mutationCancelled"})})})},{onMutate:async({resource:s,id:u,mutationMode:l,values:o,dataProviderName:a})=>{let p=M(s,a),D=t.getQueriesData(p.resourceAll),f=l!=null?l:e;return await t.cancelQueries(p.resourceAll,void 0,{silent:!0}),f!=="pessimistic"&&(t.setQueriesData(p.list(),c=>{if(!c)return null;let m=c.data.map(P=>{var C;return((C=P.id)==null?void 0:C.toString())===(u==null?void 0:u.toString())?d({id:u},o):P});return x(d({},c),{data:m})}),t.setQueriesData(p.many(),c=>{if(!c)return null;let m=c.data.map(P=>{var C;return((C=P.id)==null?void 0:C.toString())===(u==null?void 0:u.toString())&&(P=d({id:u},o)),P});return x(d({},c),{data:m})}),t.setQueriesData(p.detail(u),c=>c?x(d({},c),{data:d(d({},c.data),o)}):null)),{previousQueries:D,queryKey:p}},onSettled:(s,u,{id:l,resource:o,dataProviderName:a,invalidates:p=["list","many","detail"]})=>{i({resource:o,dataProviderName:a,invalidates:p,id:l})},onSuccess:(s,{id:u,resource:l})=>{},onError:(s,{id:u,resource:l},o)=>{if(o)for(let a of o.previousQueries)t.setQueryData(a[0],a[1]);s.message}})};var te=T("react-query");var Ke=()=>{let t=R(),r=g();return(0,te.useMutation)(({resource:n,values:i,metaData:y,dataProviderName:s})=>t(s).create({resource:n,variables:i,metaData:y}),{onSuccess:(n,{resource:i,dataProviderName:y,invalidates:s=["list","many"]})=>{r({resource:i,dataProviderName:y,invalidates:s})},onError:(n,{resource:i})=>{}})};var V=T("react-query");var Ve=()=>{let t=R(),r=(0,V.useQueryClient)(),{mutationMode:e,undoableTimeout:n}=U(),i=g();return(0,V.useMutation)(({id:s,mutationMode:u,undoableTimeout:l,resource:o,onCancel:a,metaData:p,dataProviderName:D,values:f})=>{let c=u!=null?u:e,m=l!=null?l:n;return c!=="undoable"?t(D).deleteOne({resource:o,id:s,metaData:p}):new Promise((C,v)=>{let H=()=>{t(D).deleteOne({resource:o,id:s,metaData:p}).then(Q=>C(Q)).catch(Q=>v(Q))};a&&a(()=>{v({message:"mutationCancelled"})})})},{onMutate:async({id:s,resource:u,mutationMode:l,dataProviderName:o})=>{let a=M(u,o),p=l!=null?l:e;await r.cancelQueries(a.resourceAll,void 0,{silent:!0});let D=r.getQueriesData(a.resourceAll);return p!=="pessimistic"&&(r.setQueriesData(a.list(),f=>f?{data:f.data.filter(m=>{var P;return((P=m.id)==null?void 0:P.toString())!==s.toString()}),total:f.total-1}:null),r.setQueriesData(a.many(),f=>{if(!f)return null;let c=f.data.filter(m=>{var P;return((P=m.id)==null?void 0:P.toString())!==(s==null?void 0:s.toString())});return x(d({},f),{data:c})})),{previousQueries:D,queryKey:a}},onSettled:(s,u,{id:l,resource:o,dataProviderName:a,invalidates:p=["list","many"]})=>{i({resource:o,dataProviderName:a,invalidates:p})},onSuccess:(s,{id:u,resource:l},o)=>{r.removeQueries(o.queryKey.detail(u))},onError:(s,{id:u,resource:l},o)=>{if(o)for(let a of o.previousQueries)r.setQueryData(a[0],a[1]);s.message}})};var re=T("react-query");var ae=h(T("pluralize")),Le=()=>{let t=R(),r=g();return(0,re.useMutation)(({resource:n,values:i,metaData:y,dataProviderName:s})=>t(s).createMany({resource:n,variables:i,metaData:y}),{onSuccess:(n,{resource:i,dataProviderName:y,invalidates:s=["list","many"]})=>{let u=ae.default.plural(i);r({resource:i,dataProviderName:y,invalidates:s})},onError:(n,{resource:i})=>{}})};var L=T("react-query");var ke=()=>{let t=(0,L.useQueryClient)(),r=R(),{mutationMode:e,undoableTimeout:n}=U(),i=g();return(0,L.useMutation)(({ids:s,values:u,resource:l,onCancel:o,mutationMode:a,undoableTimeout:p,metaData:D,dataProviderName:f})=>{let c=a!=null?a:e,m=p!=null?p:n;return c!=="undoable"?r(f).updateMany({resource:l,ids:s,variables:u,metaData:D}):new Promise((C,v)=>{let H=()=>{r(f).updateMany({resource:l,ids:s,variables:u,metaData:D}).then(Q=>C(Q)).catch(Q=>v(Q))};o&&o(()=>{v({message:"mutationCancelled"})})})},{onMutate:async({resource:s,ids:u,values:l,mutationMode:o,dataProviderName:a,metaData:p})=>{let D=M(s,a,p),f=o!=null?o:e;await t.cancelQueries(D.resourceAll,void 0,{silent:!0});let c=t.getQueriesData(D.resourceAll);if(f!=="pessimistic"){t.setQueriesData(D.list(),m=>{if(!m)return null;let P=m.data.map(C=>C.id!==void 0&&u.filter(v=>v!==void 0).map(String).includes(C.id.toString())?d(d({},C),l):C);return x(d({},m),{data:P})}),t.setQueriesData(D.many(),m=>{if(!m)return null;let P=m.data.map(C=>C.id!==void 0&&u.filter(v=>v!==void 0).map(String).includes(C.id.toString())?d(d({},C),l):C);return x(d({},m),{data:P})});for(let m of u)t.setQueriesData(D.detail(m),P=>{if(!P)return null;let C=d(d({},P.data),l);return x(d({},P),{data:C})})}return{previousQueries:c,queryKey:D}},onSettled:(s,u,{ids:l,resource:o,dataProviderName:a})=>{i({resource:o,invalidates:["list","many"],dataProviderName:a}),l.forEach(p=>i({resource:o,invalidates:["detail"],dataProviderName:a,id:p}))},onSuccess:(s,{ids:u,resource:l})=>{},onError:(s,{ids:u,resource:l},o)=>{if(o)for(let a of o.previousQueries)t.setQueryData(a[0],a[1]);s.message}})};var k=T("react-query");var we=()=>{let{mutationMode:t,undoableTimeout:r}=U(),e=R(),n=g(),i=(0,k.useQueryClient)();return(0,k.useMutation)(({resource:s,ids:u,mutationMode:l,undoableTimeout:o,onCancel:a,metaData:p,dataProviderName:D,values:f})=>{let c=l!=null?l:t,m=o!=null?o:r;return c!=="undoable"?e(D).deleteMany({resource:s,ids:u,metaData:p}):new Promise((C,v)=>{let H=()=>{e(D).deleteMany({resource:s,ids:u,metaData:p}).then(Q=>C(Q)).catch(Q=>v(Q))};a&&a(()=>{v({message:"mutationCancelled"})})})},{onMutate:async({ids:s,resource:u,mutationMode:l,dataProviderName:o})=>{let a=M(u,o),p=l!=null?l:t;await i.cancelQueries(a.resourceAll,void 0,{silent:!0});let D=i.getQueriesData(a.resourceAll);if(p!=="pessimistic"){i.setQueriesData(a.list(),f=>f?{data:f.data.filter(m=>m.id&&!s.map(String).includes(m.id.toString())),total:f.total-1}:null),i.setQueriesData(a.many(),f=>{if(!f)return null;let c=f.data.filter(m=>m.id?!s.map(String).includes(m.id.toString()):!1);return x(d({},f),{data:c})});for(let f of s)i.setQueriesData(a.detail(f),c=>!c||c.data.id==f?null:d({},c))}return{previousQueries:D,queryKey:a}},onSettled:(s,u,{resource:l,ids:o,dataProviderName:a,invalidates:p=["list","many"]})=>{n({resource:l,dataProviderName:a,invalidates:p})},onSuccess:(s,{ids:u,resource:l},o)=>{u.forEach(a=>i.removeQueries(o.queryKey.detail(a)))},onError:(s,{ids:u,resource:l},o)=>{if(o)for(let a of o.previousQueries)i.setQueryData(a[0],a[1]);s.message}})};var He=t=>{let r=R(),{getApiUrl:e}=r(t);return e()};var oe=T("react-query");var Ge=({url:t,method:r,config:e,queryOptions:n,metaData:i,dataProviderName:y})=>{let s=R(),{custom:u}=s(y);if(u)return(0,oe.useQuery)([y,"custom",r,t,d(d({},e),i)],()=>u(x(d({url:t,method:r},e),{metaData:i})),x(d({},n),{onSuccess:o=>{var a;(a=n==null?void 0:n.onSuccess)==null||a.call(n,o)},onError:o=>{var a;(a=n==null?void 0:n.onError)==null||a.call(n,o)}}));throw Error("Not implemented custom on data provider.")};var w=T("react");var R=()=>{let t=(0,w.useContext)(N);return(0,w.useCallback)(e=>{if(e){if(!t[e])throw new Error(`"${e}" Data provider not found`);return t[e]}if(t.default)return t.default;throw new Error('There is no "default" data provider. Please pass dataProviderName.')},[t])};var se=T("react"),ne=T("react-query");var g=()=>{let t=(0,ne.useQueryClient)();return(0,se.useCallback)(({resource:e,dataProviderName:n,invalidates:i,id:y})=>{if(i===!1)return;let s=M(e,n);i.forEach(u=>{switch(u){case"all":t.invalidateQueries(s.all);break;case"list":t.invalidateQueries(s.list());break;case"many":t.invalidateQueries(s.many());break;case"resourceAll":t.invalidateQueries(s.resourceAll);break;case"detail":t.invalidateQueries(s.detail(y||""));break;default:break}})},[])};var le=T("react");var ie=h(T("react")),ue=ie.default.createContext({mutationMode:"pessimistic",warnWhenUnsavedChanges:!1,syncWithLocation:!1,undoableTimeout:5e3});var U=()=>{let{mutationMode:t,undoableTimeout:r}=(0,le.useContext)(ue);return{mutationMode:t,undoableTimeout:r}};var de=T("react");var pe=T("react-query"),Fe=t=>{let{getPermissions:r}=(0,de.useContext)(E);return(0,pe.useQuery)("usePermissions",r,t)};var me=h(T("react"));var ce=T("react-query"),_e=()=>{let{getUserIdentity:t}=me.default.useContext(E);return(0,ce.useQuery)("getUserIdentity",t,{enabled:!!t})};var ye=h(T("react")),Te=T("react-query");var ze=()=>{let{logout:t}=ye.default.useContext(E);return(0,Te.useMutation)("useLogout",t,{onSuccess:()=>{},onError:e=>{console.log(e)}})};var fe=h(T("react")),De=T("react-query");var Ne=()=>{let{login:t}=fe.default.useContext(E);return(0,De.useMutation)("useLogin",t,{onSuccess:e=>{},onError:e=>{}})};var xe=T("react"),Ce=T("react-query");var We=t=>{let{checkAuth:r}=(0,xe.useContext)(E);return(0,Ce.useQuery)(["useAuthenticated",t],()=>r(t),{retry:!1})};var Pe=T("react");var $e=()=>{let{isAuthenticated:t}=(0,Pe.useContext)(E);return t};var Re=T("react");var Je=()=>{let{isProvided:t}=(0,Re.useContext)(E);return t||!1};})();
//# sourceMappingURL=index.js.map